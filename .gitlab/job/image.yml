---

include:
  - local: /.gitlab/common.yml

.job-build-image:
  image: docker:latest
  variables:
    DOCKERFILE: .gitlab/etc/Dockerfile
  before_script:
    - !reference [.docker-login, before_script]
  script:
    - docker build
        -f $DOCKERFILE
        -t $BUILD_IMAGE:$IMAGE_TAG
        --label org.opencontainers.image.title=$CI_PROJECT_TITLE
        --label org.opencontainers.image.url=$CI_PROJECT_URL
        .;
    - docker push $BUILD_IMAGE:$IMAGE_TAG;
